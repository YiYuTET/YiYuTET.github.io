<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>5-7 Kafka API开发 | 依羽淡蓝</title><meta name="keywords" content="Kafka"><meta name="author" content="YiYuTET,2576556095@qq.com"><meta name="copyright" content="YiYuTET"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="5-7 Kafka API开发"><meta name="application-name" content="5-7 Kafka API开发"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="5-7 Kafka API开发"><meta property="og:url" content="http://example.com/post/fa7bdefa.html"><meta property="og:site_name" content="依羽淡蓝"><meta property="og:description" content="5. Kafka 生产者API一个正常的生产逻辑需要具备以下几个步骤： （1）配置生产者参数及创建相应的生产者实例   （2）构建待发送的消息       （3）发送消息   （4）关闭生产者实例 首先引入maven依赖 1234567&amp;lt;dependencies&amp;gt;    &amp;lt;depe"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://example.com/image/kafka.png"><meta property="article:author" content="YiYuTET"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/image/kafka.png"><meta name="description" content="5. Kafka 生产者API一个正常的生产逻辑需要具备以下几个步骤： （1）配置生产者参数及创建相应的生产者实例   （2）构建待发送的消息       （3）发送消息   （4）关闭生产者实例 首先引入maven依赖 1234567&amp;lt;dependencies&amp;gt;    &amp;lt;depe"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/post/fa7bdefa"><link rel="preconnect" href="//cdn.cbd.int"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="google-site-verification" content="xxx"><meta name="baidu-site-verification" content="code-xxx"><meta name="msvalidate.01" content="xxx"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:void 0,peoplecanvas:{enable:!0,img:"https://upload-bbs.miyoushe.com/upload/2023/09/03/125766904/ee23df8517f3c3e3efc4145658269c06_5714860933110284659.png"},postHeadAiDescription:void 0,diytitle:{enable:!0,leaveTitle:"w(ﾟДﾟ)w 不要走！再看看嘛！",backTitle:"♪(^∇^*)欢迎肥来！"},LA51:{enable:!0,ck:"3HcBp2tkLPn3VSLn",LingQueMonitorID:"3HcC4I1TJLqPpAjl"},greetingBox:{enable:!0,default:"晚上好👋",list:[{greeting:"晚安😴",startTime:0,endTime:6},{greeting:"早上好鸭👋, 祝你一天好心情！",startTime:7,endTime:9},{greeting:"上午好👋, 状态很好，鼓励一下～",startTime:10,endTime:10},{greeting:"11点多啦, 在坚持一下就吃饭啦～",startTime:11,endTime:11},{greeting:"午安👋, 宝贝",startTime:12,endTime:14},{greeting:"🌈充实的一天辛苦啦！",startTime:14,endTime:18},{greeting:"19点喽, 奖励一顿丰盛的大餐吧🍔。",startTime:19,endTime:19},{greeting:"晚上好👋, 在属于自己的时间好好放松😌~",startTime:20,endTime:24}]},twikooEnvId:"https://yiyu9901-twikoo.hf.space",commentBarrageConfig:void 0,root:"/",preloader:void 0,friends_vue_info:{apiurl:"https://friends.anheyu.com/"},navMusic:!0,mainTone:{mode:"both",api:"https://img2color-go.vercel.app/api?img=",cover_change:!0},authorStatus:{skills:["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},algolia:{appId:"OCOPQS4EHM",apiKey:"39t2ndtRZKxHPHaprbe6kPaws4vs1nWA94",indexName:"yiyuyyds",hits:{per_page:6},languages:{input_placeholder:"输入关键词后按下回车查找",hits_empty:"找不到您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，用时 ${time} 毫秒"}},localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简",rightMenuMsgToTraditionalChinese:"转为繁体",rightMenuMsgToSimplifiedChinese:"转为简体"},noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:330},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,simplehomepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"作者: YiYuTET",link:"链接: ",source:"来源: 依羽淡蓝",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。",copySuccess:"复制成功，复制和转载请标注本文地址"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-center"},source:{justifiedGallery:{js:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,shortcutKey:{enable:!0,delay:100,shiftDelay:200},autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"依羽淡蓝",title:"5-7 Kafka API开发",postAI:"",pageFillDescription:"5. Kafka 生产者API, 6. Kafka 消费者API, 6.1 Kafka 消费者API示例, 6.2 subscribe订阅主题, 6.3 assign订阅主题, 6.4 subscribe和assign的区别, 6.5 取消订阅, 6.6 消息的消费模式, 6.7 自动提交消费者偏移量, 6.8 手动提交消费者偏移量(调用kafka api), 6.9 消费者提交偏移量方式的总结, 6.7 其它重要参数, 7. topic管理 API示例, 7.1 列出主题, 7.2 查看主题信息, 7.3 创建主题, 7.4 删除主题, 7.5 其它管理生产者一个正常的生产逻辑需要具备以下几个步骤配置生产者参数及创建相应的生产者实例构建待发送的消息发送消息关闭生产者实例首先引入依赖泛型要发送的数据中的泛型要发送的数据中的隐含之意中的是结构的可以没有因为底层的存储是没有类型维护机制的用户所发的所有数据类型都必须变成序列化后的所以的需要一个针对用户要发送的数据类型的序列化工具且这个序列化工具类需要实现所提供的序列工具接口代码中进行客户端参数配置的另一种写法构造一个生产者客户端将业务数据封装成客户端所能发送的封装格式调用客户端去发送数据的发送动作在的底层是异步线程去异步发送的关闭客户端消息对象除了包含业务数据外还包含了多个属性消费者消费者示例一个正常的消费逻辑需要具备以下几个步骤配置消费者客户端参数及创建相应的消费者实例订阅主题拉取消息并消费定期向主题提交消费位移关闭消费者实例构建一个来存放消费者客户端参数的消费者默认是从所属组之前所记录的偏移量开始消费如果找不到之前的记录的偏移量则从如下参数配置的策略来确定消费起始位移可以选择自动重置到每个分区的最前一条消息自动重置到每个分区的最新一条消息没有重置策略设置消费者所属的组设置自动提交最新的消费位移默认是开启的自动提交最新消费位移的时间间隔默认值就是构造一个消费者客户端订阅主题可以是多个显示指定消费起始偏移量循环往复拉取数据客户端去拉取数据的时候如果服务器没有数据响应会保持连接等待服务端响应中传入的超时时长参数是指等待的最大时长中不光有用户的业务数据还有塞入的元数据本条数据所属的本条数据所属的分区本条数据的当前这条数据所在分区的的朝代纪元在的数据底层存储中不光有用户的业务数据还有大量元数据就是其中只一记录本条数据的时间戳但是时间戳有两种类型本条数据的创建时间生产者本条数据的追加时间写入文件的时间数据头是生产者在写入数据时附加进去的相当于用户自己自定义的元数据数据数据数据所属的数据所属的数据的数据所属的纪元数据时间戳类型数据的时间戳关闭客户端订阅主题有如下重载方法指定集合方式订阅主题正则方式订阅主题如果消费者采用的是正则表达式的方式订阅在之后的过程中如果有人又创建了新的主题并且主题名字与正则表达式相匹配那么这个消费者就可以消费到新添加的主题中的消息如果应用程序需要消费多个主题并且可以处理不同的类型那么这种订阅方式就很有效正则表达式的方式订阅的示例如下利用正则表达式订阅主题可实现动态订阅订阅主题消费者不仅可以通过方法订阅主题还可以直接订阅某些主题的指定分区在中提供了方法来实现这些功能此方法的具体定义如下这个方法只接受参数用来指定需要订阅的分区集合示例如下和的区别通过方法订阅主题具有消费者自动再均衡功能在多个消费者的情况下可以根据分区分配策略来自动分配各个消费者与分区的关系当消费组的消费者增加或减少时分区分配关系会自动调整以实现消费负载均衡及故障自动转移方法订阅分区时是不具备消费者自动均衡功能的其实这一点从方法参数可以看出端倪两种类型都有类型参数的方法而方法却没有取消订阅既然有订阅那么就有取消订阅可以使用中的方法取消主题的订阅这个方法即可以取消通过方式实现的订阅也可以取消通过方式实现的订阅还可以取消通过方式实现的订阅示例如下如果将或集合参数设置为空集合作用与方法相同如下示例中三行代码的效果相同消息的消费模式中的消费是基于拉取模式的消息的消费一般有两种模式推送模式和拉取模式推送模式是服务端主动将消息推送给消费者而拉取模式消费者主动向服务端发起请求来拉取消息中的消息消费是一个不断轮询的过程消费者所要做的就是重复的调用方法方法返回的是所订阅的主题分区上的一组消息对于方法而言如果某些分区中没有可供消费的消息那么此分区对应的消息拉取的结果就为空如果订阅的所有分区中都没有可供消费的消息那么方法返回为空的信息集方法具体定义如下超过时间参数用来控制方法的阻塞时间在消费者的缓冲区里没有可用数据时会发生阻塞如果消费者程序只用来单纯拉取并消费数据则为了提高吞吐率可以把设置为自动提交消费者偏移量中默认的消费位移的提交方式是自动提交这个由消费者客户端参数配置默认值为当然这个默认的自动提交不是每消费一条消息就提交一次而是定期提交这个定期的周期时间由客户端参数配置默认值为秒此参数生效的前提是参数为在默认的方式下消费者每隔秒会将拉取到的每个分区中最大的消息位移进行提交自动位移提交的动作是在方法的逻辑里完成的在每次真正向服务端发起拉取请求之前会检查是否可以进行位移提交如果可以那么就会提交上一次轮询的位移消费的编程逻辑中位移提交是一大难点自动提交消费位移的方式非常简便它免去了复杂的位移提交逻辑让编码更简洁但随之而来的是重复消费和消息丢失的问题重复消费假设刚刚提交完一次消费位移然后拉取一批消息进行消费在下一次自动提交消费位移之前消费者崩溃了那么又得从上一次位移提交的地方重新开始消费这样便发生了重复消费的现象对于再均衡的情况同样适用我们可以通过减小位移提交的时间间隔来减小重复消息的窗口大小但这样并不能避免重复消费的发送而且也会使位移提交更加频繁丢失消息按照一般思维逻辑而言自动提交是延时提交重复消费可以理解那么消息丢失又是在什么情形下会发生的呢我们来看下图中的情形拉取线程不断地拉取消息并存入本地缓存比如在中另一个处理线程从缓存中读取消息并进行相应的逻辑处理设目前进行到了第次拉取以及第次位移提交的时候也就是之前的位移己经确认提交了处理线程却还正在处理的消息此时如果处理线程发生了异常待其恢复之后会从第次位移提交处也就是的位置开始拉取消息那么至之间的消息就没有得到相应的处理这样便发生消息丢失的现象手动提交消费者偏移量调用自动位移提交的方式在正常情况下不会发生消息丢失或重复消费的现象但是在编程的世界里异常无可避免同时自动位移提交也无法做到精确的位移管理在中还提供了手动位移提交的方式这样可以使得开发人员对消费位移的管理控制更加灵活很多时候并不是说拉取到消息就算消费完成而是需要将消息写入数据库写入本地缓存或者是更加复杂的业务处理在这些场景下所有的业务处理完成才能认为消息被成功消费手动的提交方式可以让开发人员根据程序的逻辑在合适的时机进行位移提交开启手动提交功能的前提是消费者客户端参数配置为示例如下手动提交可以细分为同步提交和异步提交对应于中的和两种类型的方法同步提交的方式方法的定义如下对于采用的无参方法它提交消费位移的频率和拉取批次消息处理批次消息的频率是一样的如果想寻求更细粒度的更精准的提交那么就需要使用的另一个有参方法具体定义如下示例代码如下提交的偏移量消费完的的偏移量因为中记录的消费偏移量代表的是消费者下一次要读取的位置异步提交的方式异步提交的方式在执行的时候消费者线程不会被阻塞可能在提交消费位移的结果还未返回之前就开始了新一次的拉取异步提交可以让消费者的性能得到一定的增强方法有一个不同的重载方法具体定义如下示例代码如下消费者提交偏移量方式的总结的消费位移提交方式全自动定时提交到半自动然后手动触发提交提交到全手动写自己的代码去把消费位移保存到你自己的地方提交到自己所涉及的存储初始化时也需要自己去从自定义存储中查询到消费位移其它重要参数一次拉取的最小字节数一次拉取的最大数据量拉取时的最大等待时长每个分区一次拉取的最大数据量一次拉取的最大条数网络连接的最大闲置时长一次请求等待响应的最大超时时长等待请求响应的最长时间元数据在限定时间内没有进行更新则会被强制更新尝试重新连接指定主机之前的退避时间尝试重新拉取数据的重试间隔管理示例如果希望将管理类的功能集成到公司内部的系统中打造集管理监控运营告警为一体的生态平台那么就需要以程序调用方式去实现工具类可以用来管理配置和管理创建主题删除主题列出所有可用的主题查看主题的信息查询配置信息修改配置信息增加分区构造一个列出主题查看主题信息创建主题参数配置创建对象由服务端自行分配分区及副本所在手动指定分区及副本的分配分区分配到分区分配到从中等待服务端返回删除主题其它管理除了进行管理外也可以进行诸如动态参数管理分区管理等各类管理操作",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-03-12 14:44:08",postMainColor:"#241E03"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{if(0===a)return;const o={value:t,expiry:Date.now()+864e5*a};localStorage.setItem(e,JSON.stringify(o))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const a=JSON.parse(t);if(!(Date.now()>a.expiry))return a.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((a,o)=>{const c=document.createElement("script");c.src=e,c.async=!0,c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},Object.keys(t).forEach(e=>{c.setAttribute(e,t[e])}),document.head.appendChild(c)}),e.getCSS=(e,t=!1)=>new Promise((a,o)=>{const c=document.createElement("link");c.rel="stylesheet",c.href=e,t&&(c.id=t),c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},document.head.appendChild(c)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};const t=saveToLocal.get("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,o=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!a&&!o&&!c;if(void 0===t){if(o)activateLightMode();else if(a)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener(e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())})}else"light"===t?activateLightMode():activateDarkMode();const d=saveToLocal.get("aside-status");void 0!==d&&("hide"===d?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://yiyuyyds.cn/" title="依羽淡蓝的博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="依羽淡蓝的博客"><span class="back-menu-item-text">依羽淡蓝的博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://upyun.com/" title="又拍云"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="又拍云"><span class="back-menu-item-text">又拍云</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://music.163.com/" title="网易云音乐"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="网易云音乐"><span class="back-menu-item-text">网易云音乐</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://7bu.top/" title="去不图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="去不图床"><span class="back-menu-item-text">去不图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.imgurl.org/" title="ImgURL"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="ImgURL"><span class="back-menu-item-text">ImgURL</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">依羽淡蓝</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=5085901384&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size:.9em"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size:.9em"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size:.9em"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size:.9em"></i><span> 我的装备</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size:.9em"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole()"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="微信" src="/null"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/null"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title">最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Kafka/" itemprop="url">Kafka</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Kafka/" tabindex="-1" itemprop="url"> <span><i class="anzhiyufont anzhiyu-icon-hashtag"></i>Kafka</span></a></span></div></div><h1 class="post-title" itemprop="name headline">5-7 Kafka API开发</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-03-12T02:03:27.000Z" title="发表于 2024-03-12 10:03:27">2024-03-12</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-03-12T06:44:08.542Z" title="更新于 2024-03-12 14:44:08">2024-03-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span data-flag-title="5-7 Kafka API开发"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"> </span><span class="post-meta-position" title="作者IP属地为南昌"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>南昌</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/post/fa7bdefa.html#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/image/kafka.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/post/fa7bdefa.html"><header><a class="post-meta-categories" href="/categories/Kafka/" itemprop="url">Kafka</a><a href="/tags/Kafka/" tabindex="-1" itemprop="url">Kafka</a><h1 id="CrawlerTitle" itemprop="name headline">5-7 Kafka API开发</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">YiYuTET</span><time itemprop="dateCreated datePublished" datetime="2024-03-12T02:03:27.000Z" title="发表于 2024-03-12 10:03:27">2024-03-12</time><time itemprop="dateCreated datePublished" datetime="2024-03-12T06:44:08.542Z" title="更新于 2024-03-12 14:44:08">2024-03-12</time></header><h1 id="5-Kafka-生产者API"><a href="#5-Kafka-生产者API" class="headerlink" title="5. Kafka 生产者API"></a>5. Kafka 生产者API</h1><p><font size="3"><b>一个正常的生产逻辑需要具备以下几个步骤： <br>（1）配置生产者参数及创建相应的生产者实例   <br>（2）构建待发送的消息       <br>（3）发送消息   <br>（4）关闭生产者实例<br></b></font></p><p><font size="3"><b>首先引入maven依赖<br></b></font></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.kafka<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>kafka-clients<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//泛型K：要发送的数据中的key</span></span><br><span class="line">        <span class="comment">//泛型V：要发送的数据中的value</span></span><br><span class="line">        <span class="comment">//隐含之意：kafka中的message，是key-value结构的（可以没有key）</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        props.setProperty(<span class="string">&quot;bootstrap.servers&quot;</span>, <span class="string">&quot;doit01:9092,doit02:9092&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//因为kafka底层的存储是没有类型维护机制的，用户所发的所有数据类型，都必须变成序列化后的byte[]</span></span><br><span class="line">        <span class="comment">//所以，kafka的producer需要一个针对用户要发送的数据类型的序列化工具</span></span><br><span class="line">        <span class="comment">//且这个序列化工具类，需要实现kafka所提供的序列工具接口，org.apache.kafka.common.serialization.Serializer</span></span><br><span class="line">        props.setProperty(<span class="string">&quot;key.serializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        props.setProperty(<span class="string">&quot;value.serializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 代码中进行客户端参数配置的另一种写法</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        props.setProperty(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="string">&quot;doit01:9092,doit02:9092&quot;</span>);</span><br><span class="line">        props.setProperty(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span><br><span class="line">        props.setProperty(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());</span><br><span class="line">        props.setProperty(ProducerConfig.ACKS_CONFIG, <span class="string">&quot;all&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造一个生产者客户端</span></span><br><span class="line">        KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(props);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            <span class="comment">//将业务数据封装成客户端所能发送的封装格式</span></span><br><span class="line">            <span class="comment">//0-&gt;abc0</span></span><br><span class="line">            <span class="comment">//1-&gt;abc1</span></span><br><span class="line">            ProducerRecord&lt;String, String&gt; message = <span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(<span class="string">&quot;abcx&quot;</span>, i + <span class="string">&quot;&quot;</span>, <span class="string">&quot;abc&quot;</span> + i);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//调用客户端去发送</span></span><br><span class="line">            <span class="comment">//数据的发送动作在producer的底层是异步线程去异步发送的</span></span><br><span class="line">            producer.send(message);</span><br><span class="line"></span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭客户端</span></span><br><span class="line">        <span class="comment">//producer.flush();</span></span><br><span class="line">        producer.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="3"><b>消息对象ProducerRecord，除了包含业务数据外，还包含了多个属性：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerRecord</span>&lt;K, V&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String topic;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Integer partition;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Headers headers;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> K key;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> V value;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Long timestamp;</span><br></pre></td></tr></table></figure><h1 id="6-Kafka-消费者API"><a href="#6-Kafka-消费者API" class="headerlink" title="6. Kafka 消费者API"></a>6. Kafka 消费者API</h1><h2 id="6-1-Kafka-消费者API示例"><a href="#6-1-Kafka-消费者API示例" class="headerlink" title="6.1 Kafka 消费者API示例"></a>6.1 Kafka 消费者API示例</h2><p><font size="3"><b>一个正常的消费逻辑需要具备以下几个步骤： <br>（1）配置消费者客户端参数及创建相应的消费者实例   <br>（2）订阅主题topic <br>（3）拉取消息并消费 <br>（4）定期向__consumer_offsets主题提交消费位移offset   <br>（5）关闭消费者实例<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ConsumerDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构建一个properties来存放消费者客户端参数</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        props.setProperty(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="string">&quot;doit01:9092&quot;</span>);</span><br><span class="line">        props.setProperty(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());</span><br><span class="line">        props.setProperty(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class.getName());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//kafka的消费者，默认是从所属组之前所记录的偏移量开始消费，如果找不到之前的记录的偏移量，则从如下参数配置的策略来确定消费起始位移</span></span><br><span class="line">        <span class="comment">//可以选择：earliest（自动重置到每个分区的最前一条消息），latest（自动重置到每个分区的最新一条消息），none（没有重置策略）</span></span><br><span class="line">        props.setProperty(ConsumerConfig.AUTO_COMMIT_INTERVAL_MS_CONFIG, <span class="string">&quot;latest&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置消费者所属的组id</span></span><br><span class="line">        props.setProperty(ConsumerConfig.GROUP_ID_CONFIG, <span class="string">&quot;d30-1&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置自动提交最新的消费位移，默认是开启的</span></span><br><span class="line">        props.setProperty(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, <span class="string">&quot;true&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//自动提交最新消费位移的时间间隔，默认值就是5000ms</span></span><br><span class="line">        props.setProperty(ConsumerConfig.AUTO_COMMIT_INTERVAL_MS_CONFIG, <span class="string">&quot;5000&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造一个消费者客户端</span></span><br><span class="line">        KafkaConsumer&lt;String, String&gt; consumer = <span class="keyword">new</span> <span class="title class_">KafkaConsumer</span>&lt;&gt;(props);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//订阅主题（可以是多个）</span></span><br><span class="line">        consumer.subscribe(Collections.singletonList(<span class="string">&quot;abcx&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//显示指定消费起始偏移量</span></span><br><span class="line">        <span class="type">TopicPartition</span> <span class="variable">abcxP0</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TopicPartition</span>(<span class="string">&quot;abcx&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="type">TopicPartition</span> <span class="variable">abcxP1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TopicPartition</span>(<span class="string">&quot;abcx&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        consumer.seek(abcxP0, <span class="number">10</span>);</span><br><span class="line">        consumer.seek(abcxP1, <span class="number">15</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//循环往复拉取数据</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">condition</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (condition) &#123;</span><br><span class="line">            <span class="comment">//客户端去拉取数据的时候，如果服务器没有数据响应，会保持连接等待服务端响应</span></span><br><span class="line">            <span class="comment">//poll中传入的超时时长参数，是指等待的最大时长</span></span><br><span class="line">            ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMinutes(Long.MAX_VALUE));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt; record : records) &#123;</span><br><span class="line">                <span class="comment">//ConsumerRecord中，不光有用户的业务数据，还有kafka塞入的元数据</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> record.key();</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> record.value();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//本条数据所属的topic</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">topic</span> <span class="operator">=</span> record.topic();</span><br><span class="line">                <span class="comment">//本条数据所属的分区</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">partition</span> <span class="operator">=</span> record.partition();</span><br><span class="line">                <span class="comment">//本条数据的offset</span></span><br><span class="line">                <span class="type">long</span> <span class="variable">offset</span> <span class="operator">=</span> record.offset();</span><br><span class="line">                <span class="comment">//当前这条数据所在分区的leader的朝代纪元</span></span><br><span class="line">                Optional&lt;Integer&gt; leaderEpoch = record.leaderEpoch();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//在kafka的数据底层存储中，不光有用户的业务数据，还有大量元数据</span></span><br><span class="line">                <span class="comment">//timestamp就是其中只一，记录本条数据的时间戳</span></span><br><span class="line">                <span class="comment">//但是时间戳有两种类型，本条数据的创建时间（生产者），本条数据的追加时间（borker写入log文件的时间）</span></span><br><span class="line">                <span class="type">TimestampType</span> <span class="variable">timestampType</span> <span class="operator">=</span> record.timestampType();</span><br><span class="line">                <span class="type">long</span> <span class="variable">timestamp</span> <span class="operator">=</span> record.timestamp();</span><br><span class="line"></span><br><span class="line">                <span class="comment">//数据头是生产者在写入数据时附加进去的（相当于用户自己自定义的元数据）</span></span><br><span class="line">                <span class="type">Headers</span> <span class="variable">headers</span> <span class="operator">=</span> record.headers();</span><br><span class="line"></span><br><span class="line">                System.out.println(String.format(<span class="string">&quot;数据key：%s, 数据value：%s, 数据所属的topic：%s, 数据所属的partition：%d,&quot;</span> +</span><br><span class="line">                                <span class="string">&quot;数据的offset：%d, 数据所属leader的纪元：%s, 数据时间戳类型：%s, 数据的时间戳：%d,&quot;</span>,</span><br><span class="line">                        key, value, topic, partition, offset, leaderEpoch.toString(), timestampType.name(), timestamp));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭客户端</span></span><br><span class="line">        consumer.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-2-subscribe订阅主题"><a href="#6-2-subscribe订阅主题" class="headerlink" title="6.2 subscribe订阅主题"></a>6.2 subscribe订阅主题</h2><p><font size="3"><b>subscribe有如下重载方法：</b></font></p><ul><li><font size="3"><b>public void subscribe(Collection<string>topics, ConsumerRebalanceListener listener)</string></b></font></li><li><font size="3"><b>public void subscribe(Collection<string>topics)</string></b></font></li><li><font size="3"><b>public void subscribe(Pattern pattern, ConsumerRebalanceListener listener)</b></font></li><li><font size="3"><b>public void subscribe(Pattern pattern)<br></b></font></li></ul><ol><li><font size="3"><b>指定集合方式订阅主题： <br>consumer.subscribe(Arrays.asList(topic1));</b></font></li><li><font size="3"><b>正则方式订阅主题<br>如果消费者采用的是正则表达式的方式(subscribe(Pattern))订阅，在之后的过程中，如果有人又创建了新的主题，并且主题名字与正则表达式相匹配，那么这个消费者就可以消费到新添加的主题中的消息。如果应用程序需要消费多个主题，并且可以处理不同的类型，那么这种订阅方式就很有效。<br>正则表达式的方式订阅的示例如下<br>consumer.subscribe(Pattern.compile(“topic.*”));<br>利用正则表达式订阅主题，可实现动态订阅。</b></font></li></ol><h2 id="6-3-assign订阅主题"><a href="#6-3-assign订阅主题" class="headerlink" title="6.3 assign订阅主题"></a>6.3 assign订阅主题</h2><p><font size="3"><b>消费者不仅可以通过KafkaConsumer.subscribe()方法订阅主题，还可以直接订阅某些主题的指定分区；<br>在KafkaConsumer中提供了assign()方法来实现这些功能，此方法的具体定义如下:   <br>public void assign(Collection<topicpartition>partitions) <br>这个方法只接受参数partitions，用来指定需要订阅的分区集合，示例如下：<br></topicpartition></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">consumer.assign(Arrays.asList(<span class="keyword">new</span> <span class="title class_">TopicPartition</span>(<span class="string">&quot;tpc_1&quot;</span>, <span class="number">0</span>), <span class="keyword">new</span> <span class="title class_">TopicPartition</span>(<span class="string">&quot;tpc_2&quot;</span>, <span class="number">1</span>)));</span><br></pre></td></tr></table></figure><h2 id="6-4-subscribe和assign的区别"><a href="#6-4-subscribe和assign的区别" class="headerlink" title="6.4 subscribe和assign的区别"></a>6.4 subscribe和assign的区别</h2><ul><li><font color="red" size="3"><b>通过subscribe()方法订阅主题具有消费者自动再均衡功能；<br></b></font></li></ul><p><font size="3"><b>在多个消费者的情况下可以根据分区分配策略来自动分配各个消费者与分区的关系。当消费组的消费者增加或减少时，分区分配关系会自动调整，以实现消费负载均衡及故障自动转移。<br></b></font></p><ul><li><font color="red" size="3"><b>assign()方法订阅分区时，是不具备消费者自动均衡功能的；<br></b></font></li></ul><p><font size="3"><b>其实这一点从assign()方法参数可以看出端倪，两种类型subscribe()都有ConsumerRebalanceListener类型参数的方法，而assign()方法却没有。<br></b></font></p><h2 id="6-5-取消订阅"><a href="#6-5-取消订阅" class="headerlink" title="6.5 取消订阅"></a>6.5 取消订阅</h2><p><font size="3"><b>既然有订阅，那么就有取消订阅。 <br>可以使用KafkaConsumer中的unsubscribe()方法取消主题的订阅，这个方法即可以取消通过subscribe(Collection)方式实现的订阅； <br>也可以取消通过subscribe(Pattern)方式实现的订阅，还可以取消通过assign(Collection)方式实现的订阅，示例如下：  <br>consumer.unsubscribe();   <br>如果将subscribe(Collection)或assign(Collection)集合参数设置为空集合，作用与unsubscribe()方法相同，如下示例中三行代码的效果相同：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">consumer.unsubscribe();</span><br><span class="line">consumer.subscribe(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;());</span><br><span class="line">consumer.assign(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;TopicPartition&gt;());</span><br></pre></td></tr></table></figure><h2 id="6-6-消息的消费模式"><a href="#6-6-消息的消费模式" class="headerlink" title="6.6 消息的消费模式"></a>6.6 消息的消费模式</h2><p><font size="3"><b><u>Kafka中的消费是基于拉取模式的。</u></b></font><br><font size="3"><b>消息的消费一般有两种模式：推送模式和拉取模式。推送模式是服务端主动将消息推送给消费者，而拉取模式消费者主动向服务端发起请求来拉取消息。</b></font></p><p><font size="3"><b>Kafka中的消息消费是一个不断轮询的过程，消费者所要做的就是重复的调用poll()方法，poll()方法返回的是所订阅的主题（分区）上的一组消息。 <br>对于poll()方法而言，如果某些分区中没有可供消费的消息，那么此分区对应的消息拉取的结果就为空，如果订阅的所有分区中都没有可供消费的消息，那么poll()方法返回为空的信息集；</b></font></p><p><font size="3"><b>poll()方法具体定义如下:   <br>public ConsumerRecords&lt;K, V&gt; poll(final Duration timeout)   <br>超过时间参数timeout，用来控制poll()方法的阻塞时间，在消费者的缓冲区里没有可用数据时会发生阻塞，如果消费者程序只用来单纯拉取并消费数据，则为了提高吞吐率，可以把timeout设置为Long.MAX_VALUE<br></b></font></p><h2 id="6-7-自动提交消费者偏移量"><a href="#6-7-自动提交消费者偏移量" class="headerlink" title="6.7 自动提交消费者偏移量"></a>6.7 自动提交消费者偏移量</h2><p><font size="3"><b>Kafka中默认的消费位移的提交方式是自动提交，这个由消费者客户端参数<u>enable.auto.commit</u>配置，默认值为true。当然这个默认的自动提交不是每消费一条消息就提交一次，而是定期提交，这个定期的周期时间由客户端参数<u>auto.commit.interval.ms</u>配置，默认值为5秒，此参数生效的前提是enable.auto.commit 参数为true。</b></font></p><p><font size="3"><b>在默认的方式下，消费者每隔5秒会将拉取到的每个分区中最大的消息位移进行提交。自动位移提交的动作是在poll()方法的逻辑里完成的，在每次真正向服务端发起拉取请求之前会检查是否可以进行位移提交，如果可以，那么就会提交上一次轮询的位移。</b></font></p><p><font size="3"><b>Kafka消费的编程逻辑中位移提交是一大难点，自动提交消费位移的方式非常简便，它免去了复杂的位移提交逻辑，让编码更简洁。但随之而来的是重复消费和消息丢失的问题。</b></font></p><ul><li><p><font size="3"><b>重复消费 <br>假设刚刚提交完一次消费位移，然后拉取一批消息进行消费，在下一次自动提交消费位移之前，消费者崩溃了，那么又得从上一次位移提交的地方重新开始消费，这样便发生了重复消费的现象（对于再均衡的情况同样适用)。我们可以通过减小位移提交的时间间隔来减小重复消息的窗口大小，但这样并不能避免重复消费的发送，而且也会使位移提交更加频繁。</b></font></p></li><li><p><font size="3"><b>丢失消息 <br>按照一般思维逻辑而言，自动提交是延时提交，重复消费可以理解，那么消息丢失又是在什么情形下会发生的呢？我们来看下图中的情形： <br>拉取线程不断地拉取消息并存入本地缓存，比如在BlockingQueue中，另一个处理线程从缓存中读取消息并进行相应的逻辑处理。设目前进行到了第y+1次拉取，以及第m次位移提交的时候，也就是x+6之前的位移己经确认提交了，处理线程却还正在处理x+3的消息；此时如果处理线程发生了异常，待其恢复之后会从第m次位移提交处，也就是x+6的位置开始拉取消息，那么x+3至x+6之间的消息就没有得到相应的处理，这样便发生消息丢失的现象。<br></b></font></p></li></ul><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/YiYuTET/ImageStorage/202304132042073.png" alt="Kafka图10"></p><h2 id="6-8-手动提交消费者偏移量-调用kafka-api"><a href="#6-8-手动提交消费者偏移量-调用kafka-api" class="headerlink" title="6.8 手动提交消费者偏移量(调用kafka api)"></a>6.8 手动提交消费者偏移量(调用kafka api)</h2><p><font size="3"><b>自动位移提交的方式在正常情况下不会发生消息丢失或重复消费的现象，但是在编程的世界里异常无可避免；同时，自动位移提交也无法做到精确的位移管理。在Kafka中还提供了手动位移提交的方式，这样可以使得开发人员对消费位移的管理控制更加灵活。</b></font></p><p><font size="3"><b>很多时候并不是说拉取到消息就算消费完成，而是需要将消息写入数据库、写入本地缓存，或者是更加复杂的业务处理。在这些场景下，所有的业务处理完成才能认为消息被成功消费；</b></font></p><p><font size="3"><b>手动的提交方式可以让开发人员根据程序的逻辑在合适的时机进行位移提交。开启手动提交功能的前<br>提是消费者客户端参数++enable.auto.commit++配置为false，示例如下：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">props.put(ConsumerConf.ENABLE_AUTO_COMMIT_CONFIG, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p><font size="3"><b>手动提交可以细分为同步提交和异步提交，对应于KafkaConsumer中的commitSync()和commitAsync()两种类型的方法；<br></b></font></p><ul><li><font size="3"><b>同步提交的方式 <br>commitSync()方法的定义如下：<br></b></font></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(<span class="number">1000</span>));</span><br><span class="line">    <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt; r : records) &#123;</span><br><span class="line">    <span class="comment">//do something to process record.</span></span><br><span class="line">    &#125;</span><br><span class="line">    consumer.commitSync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="3"><b>对于采用commitSync()的无参方法，它提交消费位移的频率和拉取批次消息、处理批次消息的频率是一样的，如果想寻求更细粒度的、更精准的提交，那么就需要使用commitSync()的另一个有参方法，具体定义如下：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commitSync</span><span class="params">(<span class="keyword">final</span> Map&lt;TopicPartition, offsetAndMetadata&gt; offsets)</span></span><br></pre></td></tr></table></figure><p><font size="3"><b>示例代码如下：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(<span class="number">1000</span>));</span><br><span class="line">    <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt;r : records)(</span><br><span class="line">        <span class="type">long</span> <span class="variable">offset</span> <span class="operator">=</span> r.offset();</span><br><span class="line">        <span class="comment">//do something to process record.</span></span><br><span class="line">        <span class="type">TopicPartition</span> <span class="variable">topicPartition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TopicPartition</span>(r.topic(), r.partition());</span><br><span class="line">        consumer.commitsync(Collections.singletonMap(topicPartition, <span class="keyword">new</span> <span class="title class_">offsetAndMetadata</span> (offset+<span class="number">1</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red" size="3"><b>提交的偏移量 &#x3D; 消费完的record的偏移量 + 1<br>因为，__consumer_offsets中记录的消费偏移量，代表的是，消费者下一次要读取的位置！！!<br></b></font></p><ul><li><font size="3"><b>异步提交的方式 <br>异步提交的方式(commitAsync())在执行的时候消费者线程不会被阻塞；可能在提交消费位移的结果还未返回之前就开始了新一次的拉取。异步提交可以让消费者的性能得到一定的增强。 <br>commitAsync方法有一个不同的重载方法，具体定义如下：<br></b></font></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commitAsync</span><span class="params">()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commitAsync</span><span class="params">(OffsetCommitCallback callback)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commitAsync</span><span class="params">(<span class="keyword">final</span> Map&lt;TopicPartition, OffsetAndMetadata&gt; offsets, offsetCommitCallback callback)</span></span><br></pre></td></tr></table></figure><p><font size="3"><b>示例代码如下：<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(<span class="number">1000</span>));</span><br><span class="line">    <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt; r : records) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">offset</span> <span class="operator">=</span> r.offset ()</span><br><span class="line">        <span class="comment">//do something to process record.</span></span><br><span class="line">        <span class="type">TopicPartition</span> <span class="variable">topicPartition</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TopicPartition</span>(r.topic(), r.partition());</span><br><span class="line">        consumer.commitSync(Collections.singletonMap(topicPartition, <span class="keyword">new</span> <span class="title class_">OffsetAndMetadata</span>(offset+<span class="number">1</span>)));</span><br><span class="line">        consumer.commitAsync(Collections.singletonMap(topicPartition, <span class="keyword">new</span> <span class="title class_">offsetAndMetadata</span>(offset+<span class="number">1</span>)), <span class="keyword">new</span> <span class="title class_">offsetcommitcallback</span>() &#123;</span><br><span class="line">        <span class="meta">@override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">(Map&lt;TopicPartition, offsetAndMetadata&gt; map, Exception e)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(e == <span class="literal">null</span> ) &#123;</span><br><span class="line">                System.out.printIn (map);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                System.out.println (<span class="string">&quot;error commit offset&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-9-消费者提交偏移量方式的总结"><a href="#6-9-消费者提交偏移量方式的总结" class="headerlink" title="6.9 消费者提交偏移量方式的总结"></a>6.9 消费者提交偏移量方式的总结</h2><p><font size="3"><b>consumer的消费位移提交方式：</b></font></p><ol><li><font size="3"><b>全自动 auto.offset..commit &#x3D; true -&gt; 定时提交到consumer_offsets</b></font></li><li><font size="3"><b>半自动 auto.offset.commit &#x3D; false；然后手动触发提交consumer.commitSync()； -&gt; 提交到consumer_offsets</b></font></li><li><font size="3"><b>全手动 auto.offset.commit &#x3D; false；写自己的代码去把消费位移保存到你自己的地方<br>mysql&#x2F;zk&#x2F;redis&#x2F; -&gt; 提交到自己所涉及的存储；初始化时也需要自己去从自定义存储中查询到消费位移</b></font></li></ol><h2 id="6-7-其它重要参数"><a href="#6-7-其它重要参数" class="headerlink" title="6.7 其它重要参数"></a>6.7 其它重要参数</h2><ul><li><font size="3"><b>fetch.min.bytes&#x3D;1B （一次拉取的最小字节数）</b></font></li><li><font size="3"><b>fetch.max.bytes&#x3D;50M （一次拉取的最大数据量）</b></font></li><li><font size="3"><b>fetch.max.wait.ms&#x3D;500ms (拉取时的最大等待时长</b></font>)</li><li><font size="3"><b>max.partition.fetch.bytes&#x3D;1MB （每个分区一次拉取的最大数据量）</b></font></li><li><font size="3"><b>max.poll.records&#x3D;500 （一次拉取的最大条数）</b></font></li><li><font size="3"><b>connections.max.idle.ms&#x3D;540000ms （网络连接的最大闲置时长）</b></font></li><li><font size="3"><b>request.timeout.ms&#x3D;30000ms （一次请求等待响应的最大超时时长，consumer等待请求响应的最长时间）</b></font></li><li><font size="3"><b>metadata.max.age.ms&#x3D;300000 （元数据在限定时间内没有进行更新，则会被强制更新）</b></font></li><li><font size="3"><b>reconnect.backoff.ms&#x3D;50ms （尝试重新连接指定主机之前的退避时间）</b></font></li><li><font size="3"><b>retry.backoff.ms&#x3D;100ms （尝试重新拉取数据的重试间隔）<br></b></font></li></ul><h1 id="7-topic管理-API示例"><a href="#7-topic管理-API示例" class="headerlink" title="7. topic管理 API示例"></a>7. topic管理 API示例</h1><p><font size="3"><b>如果希望将管理类的功能集成到公司内部的系统中，打造集管理、监控、运营、告警为一体的生态平台，那么就需要以程序调用API方式去实现。 <br>工具类KafkaAdminClient可以用来管理broker、配置和ACL(Access Control List)，管理topic。<br></b></font></p><ul><li><font size="3"><b>创建主题：CreateTopicsResult createTopics(Collection&lt;NewTopic&gt; newTopics)</b></font></li><li><font size="3"><b>删除主题：DeleteTopicsResult deleteTopics(Collection&lt;String&gt; topics)</b></font></li><li><font size="3"><b>列出所有可用的主题：ListTopicsResult listTopics()</b></font></li><li><font size="3"><b>查看主题的信息：DescribeTopicsResult describeTopics(Collection&lt;String&gt; topicNames)</b></font></li><li><font size="3"><b>查询配置信息：DescribeConfigsResult describeConfigs(Collection&lt;\ConfigResource&gt;<br>resources)</b></font></li><li><font size="3"><b>修改配置信息：AlterConfigsResult alterConfigs(Map&lt;ConfigResource,Config&gt; configs)</b></font></li><li><font size="3"><b>增加分区：CreatePartitionsResult createPartitions(Map&lt;String,NewPartitions&gt; newPartitions)<br></b></font></li></ul><p><font size="3"><b>构造一个KafkaAdminClient<br></b></font></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">AdminClient</span> <span class="variable">adminClient</span> <span class="operator">=</span> KafkaAdminClient.create(props);</span><br></pre></td></tr></table></figure><h2 id="7-1-列出主题"><a href="#7-1-列出主题" class="headerlink" title="7.1 列出主题"></a>7.1 列出主题</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ListTopicsResult</span> <span class="variable">listTopicsResult</span> <span class="operator">=</span> adminClient.listTopics();</span><br><span class="line">Set&lt;String&gt; topics = listTopicsResult.names().get();</span><br><span class="line">System.out.printIn(topics);</span><br></pre></td></tr></table></figure><h2 id="7-2-查看主题信息"><a href="#7-2-查看主题信息" class="headerlink" title="7.2 查看主题信息"></a>7.2 查看主题信息</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DescribeTopicsResult</span> <span class="variable">describeTopicsResult</span> <span class="operator">=</span> adminClient.describeTopics(Arrays.asList (<span class="string">&quot;tpc_4&quot;</span>, <span class="string">&quot;tpc_3&quot;</span>));</span><br><span class="line">Map&lt;String, TopicDescription&gt; res = describeTopicsResult.all().get();</span><br><span class="line">Set&lt;String&gt; ksets = res.keySet();</span><br><span class="line"><span class="keyword">for</span> (String k : ksets) &#123;</span><br><span class="line">    System.out.println(res.get(k));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-3-创建主题"><a href="#7-3-创建主题" class="headerlink" title="7.3 创建主题"></a>7.3 创建主题</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//参数配置</span></span><br><span class="line"><span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">props.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="string">&quot;doit01:9092,doit02:9092,doit03:</span></span><br><span class="line"><span class="string">9092&quot;</span>)；</span><br><span class="line">props.put(AdminClientConfig.REQUEST_TIMEOUT_MS_CONFIG, <span class="number">3000</span>);</span><br><span class="line"><span class="comment">//创建admin client对象</span></span><br><span class="line"><span class="type">AdminClient</span> <span class="variable">adminClient</span> <span class="operator">=</span> KafkaAdminClient.create(props);</span><br><span class="line"><span class="comment">//由服务端controller自行分配分区及副本所在broker</span></span><br><span class="line"><span class="type">NewTopic</span> <span class="variable">tpc_3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NewTopic</span>(<span class="string">&quot;tpc_3&quot;</span>, <span class="number">2</span>, (<span class="type">short</span>) <span class="number">1</span>);</span><br><span class="line"><span class="comment">//手动指定分区及副本的broker分配</span></span><br><span class="line">HashMap&lt;Integer, List&lt;Integer&gt;&gt; replicaAssignments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//分区0，分配到broker0,broker1</span></span><br><span class="line">replicaAssignments.put(<span class="number">0</span>, Arrays.asList(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line"><span class="comment">//分区1，分配到broker0,broker2</span></span><br><span class="line">replicaAssignments.put(<span class="number">1</span>, Arrays.asList(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="type">NewTopic</span> <span class="variable">tpc_4</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NewTopic</span>(<span class="string">&quot;tpc_4&quot;</span>, replicaAssignments);</span><br><span class="line"><span class="type">CreateTopicsResult</span> <span class="variable">result</span> <span class="operator">=</span> adminClient.createTopics(Arrays.asList(tpc_3, tpc_4));</span><br><span class="line"></span><br><span class="line"><span class="comment">//从future中等待服务端返回</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    result.all().get()；</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line">adminClient.close();</span><br></pre></td></tr></table></figure><h2 id="7-4-删除主题"><a href="#7-4-删除主题" class="headerlink" title="7.4 删除主题"></a>7.4 删除主题</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DeleteTopicsResult</span> <span class="variable">deleteTopicsResult</span> <span class="operator">=</span> adminClient.deleteTopics(Arrays.asList(<span class="string">&quot;tpc_1&quot;</span>, </span><br><span class="line"><span class="string">&quot;tpc_1&quot;</span>)):</span><br><span class="line">Map&lt;String, KafkaFuture&lt;Void&gt;&gt; values = deleteTopicsResult.values();</span><br><span class="line">System.out.printIn(values);</span><br></pre></td></tr></table></figure><h2 id="7-5-其它管理"><a href="#7-5-其它管理" class="headerlink" title="7.5 其它管理"></a>7.5 其它管理</h2><p><font size="3"><b>除了进行topic管理外，KafkaAdminClient也可以进行诸如动态参数管理，分区管理等各类管理操作；<br></b></font></p></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/02/29/8f4db1ac8f79a3be.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/02/29/8f4db1ac8f79a3be.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">YiYuTET</div><div class="post-copyright__author_desc">分享技术与快乐的博主</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/post/fa7bdefa.html">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("http://example.com/post/fa7bdefa.html")'>5-7 Kafka API开发</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/null" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display:none"></div><div class="reward-link mode"><a class="reward-link-button" href="/wechat/"><i class="anzhiyufont anzhiyu-icon-plant-fill"></i>运营模式与责任</a></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/post/fa7bdefa.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=5-7 Kafka API开发&amp;url=http://example.com/post/fa7bdefa.html&amp;pic=/image/kafka.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">依羽淡蓝</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Kafka/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span>Kafka<span class="tagsPageCount">6</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/image/flink.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/79d4ebb8.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">4. Kafka 命令行工具</div></div></a></div><div class="next-post pull-right"><a href="/post/b2c5a78a.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">8-9 Kafka 系统架构</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/post/58eeb88f.html" title="1-3 Kafka 简介"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-12</div><div class="title">1-3 Kafka 简介</div></div></a></div><div><a href="/post/79d4ebb8.html" title="4. Kafka 命令行工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-12</div><div class="title">4. Kafka 命令行工具</div></div></a></div><div><a href="/post/b2c5a78a.html" title="8-9 Kafka 系统架构"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-12</div><div class="title">8-9 Kafka 系统架构</div></div></a></div><div><a href="/post/216d6a00.html" title="10. Kafka 关键原理加强"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-12</div><div class="title">10. Kafka 关键原理加强</div></div></a></div><div><a href="/post/8716a180.html" title="云服务器伪分布式部署Kafka"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/kafka.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-12</div><div class="title">云服务器伪分布式部署Kafka</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left:4px">隐私政策</a></div><div class="comment-switch"><span class="first-comment">Twikoo</span><span id="switch-btn"></span><span class="second-comment">Waline</span></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/02/29/8f4db1ac8f79a3be.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"></div></div><div class="author-info__description"><div style="line-height:1.38;margin:.6rem 0;text-align:justify;color:rgba(255,255,255,.8)">这有关于<b style="color:#fff">Java、大数据、算法</b>相关的问题和看法，还有<b style="color:#fff">文章总结</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:.6rem 0;text-align:justify;color:rgba(255,255,255,.8)">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">YiYuTET</h1><div class="author-info__desc">分享技术与快乐的博主</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/YiYuTET" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/201372650" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background:url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center/100% no-repeat"></div><div class="back face" style="background:url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center/100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#5-Kafka-%E7%94%9F%E4%BA%A7%E8%80%85API"><span class="toc-number">1.</span> <span class="toc-text">5. Kafka 生产者API</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Kafka-%E6%B6%88%E8%B4%B9%E8%80%85API"><span class="toc-number">2.</span> <span class="toc-text">6. Kafka 消费者API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-Kafka-%E6%B6%88%E8%B4%B9%E8%80%85API%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.1.</span> <span class="toc-text">6.1 Kafka 消费者API示例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-subscribe%E8%AE%A2%E9%98%85%E4%B8%BB%E9%A2%98"><span class="toc-number">2.2.</span> <span class="toc-text">6.2 subscribe订阅主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-assign%E8%AE%A2%E9%98%85%E4%B8%BB%E9%A2%98"><span class="toc-number">2.3.</span> <span class="toc-text">6.3 assign订阅主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-subscribe%E5%92%8Cassign%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.4.</span> <span class="toc-text">6.4 subscribe和assign的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85"><span class="toc-number">2.5.</span> <span class="toc-text">6.5 取消订阅</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-6-%E6%B6%88%E6%81%AF%E7%9A%84%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F"><span class="toc-number">2.6.</span> <span class="toc-text">6.6 消息的消费模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E6%B6%88%E8%B4%B9%E8%80%85%E5%81%8F%E7%A7%BB%E9%87%8F"><span class="toc-number">2.7.</span> <span class="toc-text">6.7 自动提交消费者偏移量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-8-%E6%89%8B%E5%8A%A8%E6%8F%90%E4%BA%A4%E6%B6%88%E8%B4%B9%E8%80%85%E5%81%8F%E7%A7%BB%E9%87%8F-%E8%B0%83%E7%94%A8kafka-api"><span class="toc-number">2.8.</span> <span class="toc-text">6.8 手动提交消费者偏移量(调用kafka api)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-9-%E6%B6%88%E8%B4%B9%E8%80%85%E6%8F%90%E4%BA%A4%E5%81%8F%E7%A7%BB%E9%87%8F%E6%96%B9%E5%BC%8F%E7%9A%84%E6%80%BB%E7%BB%93"><span class="toc-number">2.9.</span> <span class="toc-text">6.9 消费者提交偏移量方式的总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-7-%E5%85%B6%E5%AE%83%E9%87%8D%E8%A6%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.10.</span> <span class="toc-text">6.7 其它重要参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-topic%E7%AE%A1%E7%90%86-API%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.</span> <span class="toc-text">7. topic管理 API示例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%88%97%E5%87%BA%E4%B8%BB%E9%A2%98"><span class="toc-number">3.1.</span> <span class="toc-text">7.1 列出主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E6%9F%A5%E7%9C%8B%E4%B8%BB%E9%A2%98%E4%BF%A1%E6%81%AF"><span class="toc-number">3.2.</span> <span class="toc-text">7.2 查看主题信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%A2%98"><span class="toc-number">3.3.</span> <span class="toc-text">7.3 创建主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4-%E5%88%A0%E9%99%A4%E4%B8%BB%E9%A2%98"><span class="toc-number">3.4.</span> <span class="toc-text">7.4 删除主题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5-%E5%85%B6%E5%AE%83%E7%AE%A1%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text">7.5 其它管理</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/971239a4.html" title="1.Flink简介"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/flink.jpeg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="1.Flink简介"></a><div class="content"><a class="title" href="/post/971239a4.html" title="1.Flink简介">1.Flink简介</a><time datetime="2024-03-12T08:29:12.000Z" title="发表于 2024-03-12 16:29:12">2024-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/9aba4271.html" title="云服务器安装Flink"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/flink.jpeg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="云服务器安装Flink"></a><div class="content"><a class="title" href="/post/9aba4271.html" title="云服务器安装Flink">云服务器安装Flink</a><time datetime="2024-03-12T08:26:13.000Z" title="发表于 2024-03-12 16:26:13">2024-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/41b91bba.html" title="云服务器伪分布式部署Spark"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/spark.jpeg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="云服务器伪分布式部署Spark"></a><div class="content"><a class="title" href="/post/41b91bba.html" title="云服务器伪分布式部署Spark">云服务器伪分布式部署Spark</a><time datetime="2024-03-12T06:31:43.000Z" title="发表于 2024-03-12 14:31:43">2024-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/e6cd08d.html" title="Hue集成HBase"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/hue.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hue集成HBase"></a><div class="content"><a class="title" href="/post/e6cd08d.html" title="Hue集成HBase">Hue集成HBase</a><time datetime="2024-03-12T06:30:54.000Z" title="发表于 2024-03-12 14:30:54">2024-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/2349cfef.html" title="Hue集成MySQL"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/image/hue.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Hue集成MySQL"></a><div class="content"><a class="title" href="/post/2349cfef.html" title="Hue集成MySQL">Hue集成MySQL</a><time datetime="2024-03-12T06:30:23.000Z" title="发表于 2024-03-12 14:30:23">2024-03-12</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="/2576556095@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/6378063631" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100092208016287&amp;sk=about" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0,500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/02/29/8f4db1ac8f79a3be.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/372204786" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/DwCpMEy/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div id="workboard"><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v7.1.1" title="博客框架为Hexo_v7.1.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v7.1.1"></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"></a><a class="github-badge" target="_blank" href="https://www.upyun.com/" style="margin-inline:5px" data-title="本站使用又拍云为静态资源提供CDN加速" title="本站使用又拍云为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://unpkg.com/yiyutet-static@1.0.2/image/CDN.svg" alt="本站使用又拍云为静态资源提供CDN加速"></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="YiYuTET" target="_blank">YiYuTET</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType(){fetch("https://v1.hitokoto.cn").then(t=>t.json()).then(t=>{{const e="出自 "+t.from,p=["生活明朗，万物可爱，人间值得，未来可期。","手握日月摘 ♥ 辰。","天若有情天亦老，人间正道是沧桑。","三十功名尘与土，八千里路云和月。","此去黄泉招旧部，旌旗十万斩阎罗。"];p.unshift(t.hitokoto,e),window.typed=new Typed("#footer-type-tips",{strings:p,startDelay:300,typeSpeed:150,loop:!0,backSpeed:50})}})}"function"==typeof Typed?subtitleType():getScript("https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js").then(subtitleType)</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="赣ICP备2022002607号">赣ICP备2022002607号</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">10</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://yiyuyyds.cn/" title="依羽淡蓝的博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="依羽淡蓝的博客"><span class="back-menu-item-text">依羽淡蓝的博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://upyun.com/" title="又拍云"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="又拍云"><span class="back-menu-item-text">又拍云</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://music.163.com/" title="网易云音乐"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="网易云音乐"><span class="back-menu-item-text">网易云音乐</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://7bu.top/" title="去不图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="去不图床"><span class="back-menu-item-text">去不图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.imgurl.org/" title="ImgURL"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="ImgURL"><span class="back-menu-item-text">ImgURL</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i><span> 总览</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=5085901384&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size:.9em"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size:.9em"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size:.9em"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size:.9em"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size:.9em"></i><span> 我的装备</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size:.9em"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i><span> 留言板</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI/" style="font-size:.88rem">AI<sup>1</sup></a><a href="/tags/Azkaban/" style="font-size:.88rem">Azkaban<sup>1</sup></a><a href="/tags/Flink/" style="font-size:.88rem">Flink<sup>2</sup></a><a href="/tags/HBase/" style="font-size:.88rem">HBase<sup>2</sup></a><a href="/tags/Hadoop/" style="font-size:.88rem">Hadoop<sup>1</sup></a><a href="/tags/Hive/" style="font-size:.88rem">Hive<sup>1</sup></a><a href="/tags/Hue/" style="font-size:.88rem">Hue<sup>4</sup></a><a href="/tags/Kafka/" style="font-size:.88rem">Kafka<sup>6</sup></a><a href="/tags/Spark/" style="font-size:.88rem">Spark<sup>1</sup></a><a href="/tags/ZooKeeper/" style="font-size:.88rem">ZooKeeper<sup>1</sup></a><a href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" style="font-size:.88rem">安装教程<sup>12</sup></a></div></div><hr></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift F</div></div><div class="keyContent"><div class="content">友链鱼塘</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="anzhiyufont anzhiyu-icon-comment-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="5085901384" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/9164517845&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>var HoldLog=console.log;console.log=function(){};let now1=new Date;queueMicrotask(()=>{const o=function(){HoldLog.apply(console,arguments)},n=new Date("02/22/2024 00:00:00");now1.setTime(now1.getTime()+250);const c=(now1-n)/1e3/60/60/24,e=["欢迎使用安知鱼!","生活明朗, 万物可爱","\n        \n       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗\n      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║\n      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║\n      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║\n      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝\n      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝\n        \n        ","已上线",Math.floor(c),"天","©2024 By 安知鱼 V1.6.12"],t=["NCC2-036","调用前置摄像头拍照成功，识别为【小笨蛋】.","Photo captured: ","🤪"];setTimeout(o.bind(console,`\n%c${e[0]} %c ${e[1]} %c ${e[2]} %c${e[3]}%c ${e[4]}%c ${e[5]}\n\n%c ${e[6]}\n`,"color:#425AEF","","color:#425AEF","color:#425AEF","","color:#425AEF","")),setTimeout(o.bind(console,`%c ${t[0]} %c ${t[1]} %c \n${t[2]} %c\n${t[3]}\n`,"color:white; background-color:#4fd953","","",'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%')),setTimeout(o.bind(console,"%c WELCOME %c 你好，小笨蛋.","color:white; background-color:#4f90d9","")),setTimeout(console.warn.bind(console,"%c ⚡ Powered by 安知鱼 %c 你正在访问 YiYuTET 的博客.","color:white; background-color:#f0ad4e","")),setTimeout(o.bind(console,"%c W23-12 %c 你已打开控制台.","color:white; background-color:#4f90d9","")),setTimeout(console.warn.bind(console,"%c S013-782 %c 你现在正处于监控中.","color:white; background-color:#d9534f",""))})</script><script async src="/anzhiyu/random.js"></script><script async>!function(){var e,t,n,r,a,i=new Date("02/22/2024 00:00:00"),o=new Date;setInterval(()=>{!function(){o=new Date,a=o.getHours();var l=(o-i)/1e3/60/60/24;e=Math.floor(l);var u=(o-i)/1e3/60/60-24*e;t=Math.floor(u),1==String(t).length&&(t="0"+t);var c=(o-i)/1e3/60-1440*e-60*t;n=Math.floor(c),1==String(n).length&&(n="0"+n);var s=(o-i)/1e3-86400*e-3600*t-60*n;r=Math.round(s),1==String(r).length&&(r="0"+r)}(),function(){if(!document.getElementById("footer"))return;let i="";if(a<18&&a>=9)i=`本站居然运行了 ${e} 天<span id='runtime'> ${t} 小时 ${n} 分 ${r} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;else{let a=document.querySelector("#workboard .workSituationImg");null!=a&&(a.src="",a.title="",a.alt=""),i=`本站居然运行了 ${e} 天<span id='runtime'> ${t} 小时 ${n} 分 ${r} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`}document.getElementById("runtimeTextTip")&&(document.getElementById("runtimeTextTip").innerHTML=i)}()},1e3)}()</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{const t=()=>{"object"==typeof twikoo?setTimeout(o,0):getScript("https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js").then(o)},o=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://yiyu9901-twikoo.hf.space",region:"ap-nanchang",onCommentLoaded:()=>{anzhiyu.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&(()=>{const t=document.getElementById("twikoo-count");t&&twikoo.getCommentsCount({envId:"https://yiyu9901-twikoo.hf.space",region:"ap-nanchang",urls:[window.location.pathname],includeReply:!1}).then(o=>{t.textContent=o[0].count}).catch(t=>{console.error(t)})})()};t()})()</script><script>(()=>{const t=()=>{Waline.init(Object.assign({el:"#waline-wrap",serverURL:"https://waline-2ig2mjss4-yiyutets-projects.vercel.app/",pageview:!1,dark:'html[data-theme="dark"]',path:window.location.pathname,comment:!0},null))},e=async()=>{"object"==typeof Waline||(await getCSS("https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.css"),await getScript("https://cdn.cbd.int/@waline/client@2.15.5/dist/waline.js")),t()};setTimeout(e,0)})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener("load",()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'><div class='name'><span>${e[n].nick} </span></div></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <time datetime="${e[n].date}">${anzhiyu.diffDate(e[n].date,!0)}</time></div>\n        </div>`}else t+="没有评论";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://yiyu9901-twikoo.hf.space",region:"ap-nanchang",pageSize:6,includeReply:!0}).then((function(t){const n=t.map(e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t});saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}))};"object"==typeof twikoo?t():getScript("https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)})</script><script async data-pjax src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail="visitor@yiyutet.com"</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer id="fluttering_ribbon" mobile="true" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script>(()=>{{const a=()=>{Chatra("minimizeWidget"),Chatra("hide")},t=()=>{Chatra("openChat",!0),Chatra("show")};window.ChatraSetup={startHidden:!0},window.chatBtnFn=()=>{document.getElementById("chatra").classList.contains("chatra--expanded")?a():t()}}!function(a,t,n){t.ChatraID="Q6Jamb3w4rWdjgCzA";var e=a.createElement("script");t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},e.async=!0,e.src="https://call.chatra.io/chatra.js",a.head&&a.head.appendChild(e)}(document,window,"Chatra")})()</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]','meta[property="og:type"]','meta[property="og:site_name"]','meta[property="og:description"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script data-pjax>function butterfly_clock_anzhiyu_injector_config(){var e=document.getElementsByClassName("sticky_layout")[0];console.log("已挂载butterfly_clock_anzhiyu"),e&&e.insertAdjacentHTML("afterbegin",'<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>')}for(var elist="null".split(","),cpage=location.pathname,epage="all",qweather_key="841fa5c76e5a4ca59a8f5b618e989540# 和风天气key",gaud_map_key="374456b7f8ca92155e3fb0c1f99c2b78# 高得地图web服务key",baidu_ak_key="undefined",flag=0,clock_rectangle="112.982279,28.19409",clock_default_rectangle_enable="false",i=0;i<elist.length;i++)cpage.includes(elist[i])&&flag++;("all"===epage&&0==flag||epage===cpage)&&butterfly_clock_anzhiyu_injector_config()</script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script></body></html>